# Issue: Update command inline documentation

## Overview
# Issue #005.1: Update command inline documentation

## Overview
Update inline documentation in both PRD commands to reflect the enhanced validation logic, error handling, and recovery mechanisms.

## Files to Modify
1. `.claude/commands/cccc/prd/new.md` (modify)
2. `.claude/commands/cccc/prd/parse.md` (modify)

## Implementation Sketch

### Enhanced Documentation for PRD New Command

Add comprehensive documentation sections:

```markdown
## Enhanced Usage Documentation

### Command Overview
Creates a new Product Requirements Document (PRD) with standardized YAML frontmatter, validation, and comprehensive error handling.

### Usage Examples

#### Basic PRD Creation
```bash
/cccc:prd:new my-feature
# Creates: .cccc/prds/my-feature.md with standard template
```

#### PRD Creation with Validation
```bash
/cccc:prd:new complex-feature-name
# ✅ Validates name format (alphanumeric, dash, underscore)
# 📁 Creates .cccc/prds/ directory if needed
# 📝 Generates standardized YAML frontmatter
# ⚠️ Prompts for confirmation if PRD exists
```

### Error Scenarios and Solutions

#### Invalid PRD Names
```
❌ Error: PRD name contains invalid characters
💡 Solution: Use only letters, numbers, dash, underscore
📝 Example: "user-auth-v2" or "payment_integration"
```

#### Directory Permission Issues
```
❌ Error: Failed to create directory: .cccc/prds
💡 Solution: Check file permissions and disk space
🔧 Recovery: .claude/scripts/cccc/error-recovery.sh validate-state
```

#### Existing PRD Conflicts
```
⚠️ Warning: PRD already exists: .cccc/prds/my-feature.md
Overwrite existing PRD? (yes/no): 
💡 Type 'yes' to overwrite or 'no' to cancel
💾 Backup created automatically before overwrite
```

### Validation Rules

- **Name Length**: Maximum 50 characters
- **Name Format**: Alphanumeric, dash (-), underscore (_) only
- **Required Fields**: name, status, created, version, author
- **YAML Format**: Valid YAML frontmatter with proper delimiters

### Recovery Information

If PRD creation fails:
1. **Automatic Recovery**: System cleans up partial files
2. **Backup Restoration**: Previous PRD backed up before overwrite
3. **Manual Recovery**: `.claude/scripts/cccc/error-recovery.sh prd-creation <name>`
4. **System Validation**: `.claude/scripts/cccc/error-recovery.sh validate-state`

### Troubleshooting Guide

| Problem | Cause | Solution |
|---------|-------|----------|
| Name validation fails | Invalid characters | Use only letters, numbers, dash, underscore |
| Directory creation fails | Permission issues | Check write permissions on .cccc directory |
| YAML generation fails | System error | Run recovery script to validate system state |
| File write fails | Disk space/permissions | Free up space, check file permissions |
```

### Enhanced Documentation for PRD Parse Command

```markdown
## Enhanced Parse Documentation

### Command Overview
Parses an existing PRD file to generate a structured epic with task decomposition, validation, and comprehensive error handling.

### Usage Examples

#### Basic PRD Parsing
```bash
/cccc:prd:parse my-feature
# 🔍 Validates PRD exists and is readable
# ✅ Validates YAML frontmatter structure
# 📝 Parses content into structured epic
# 📁 Creates .cccc/epics/my-feature/ directory
```

#### Parse with Validation Details
```bash
/cccc:prd:parse complex-feature
# Step 1: PRD existence validation
# Step 2: YAML frontmatter validation
# Step 3: Content structure validation
# Step 4: Epic generation prerequisites
# Step 5: Epic creation and task generation
# Step 6: Generated epic validation
```

### Pre-Parse Validation

#### PRD File Validation
- **Existence**: File must exist in `.cccc/prds/`
- **Readability**: File must be readable
- **Content**: File must not be empty
- **Format**: Must start and end with YAML frontmatter delimiters

#### Required YAML Fields
- `name`: PRD name (non-empty string)
- `status`: Valid status (draft|review|approved|implemented)
- `created`: ISO 8601 timestamp
- `version`: Semantic version string

#### Required Content Sections
- `## Problem Statement`: Problem definition
- `## Solution Overview`: High-level solution
- `## User Stories`: Stories with **As a**/**I want**/**So that** format

### Error Scenarios and Solutions

#### PRD Not Found
```
❌ PRD not found: .cccc/prds/missing-feature.md
💡 Available PRDs:
   • user-auth
   • payment-flow
   • admin-dashboard
```

#### Invalid YAML Frontmatter
```
❌ Missing required field 'name' in: .cccc/prds/my-feature.md
💡 Required fields: name status created version
🔧 Fix frontmatter and retry parsing
```

#### Missing Content Sections
```
❌ Missing required section '## User Stories' in: .cccc/prds/my-feature.md
💡 Required sections: Problem Statement, Solution Overview, User Stories
```

#### Epic Directory Conflicts
```
⚠️ Epic directory already exists: .cccc/epics/my-feature
Overwrite existing epic? (yes/no):
💾 Backup created before overwrite
```

### Epic Generation Process

1. **Validation Phase**: PRD structure and content validation
2. **Preparation Phase**: Directory setup and backup creation
3. **Parsing Phase**: Content extraction and task generation
4. **Generation Phase**: Epic and task file creation
5. **Validation Phase**: Generated epic structure validation
6. **Completion Phase**: Success reporting and next steps

### Recovery Information

If PRD parsing fails:
1. **Automatic Cleanup**: Partial epic directories removed
2. **Backup Restoration**: Previous epic backed up before overwrite
3. **Manual Recovery**: `.claude/scripts/cccc/error-recovery.sh prd-parsing <name>`
4. **PRD Validation**: Check and fix source PRD issues

### Troubleshooting Guide

| Problem | Cause | Solution |
|---------|-------|----------|
| PRD not found | Wrong name or location | Check available PRDs, verify name |
| Invalid frontmatter | YAML syntax errors | Fix YAML structure and required fields |
| Missing sections | Incomplete PRD content | Add required sections to PRD |
| Epic generation fails | Permissions/disk space | Check permissions and available space |
| Validation fails | Corrupted generated files | Re-run parsing or use recovery tools |
```

## Acceptance Criteria
- [ ] Both commands have comprehensive usage examples
- [ ] Error scenarios documented with specific solutions
- [ ] Validation rules clearly explained
- [ ] Recovery procedures documented
- [ ] Troubleshooting guides with common problems
- [ ] Step-by-step process documentation
- [ ] Integration with enhanced validation and error handling
- [ ] Clear formatting with emoji indicators and tables

## Dependencies
- Issue #004.2: New command error handling must be complete
- Issue #004.3: Parse command error handling must be complete

## Definition of Done
- [ ] Code implemented according to implementation sketch
- [ ] All acceptance criteria met
- [ ] Documentation follows CCCC patterns and standards
- [ ] Clear, actionable guidance for users
- [ ] Ready for workflow examples documentation (Issue #005.2)\n\n---\nDepends on #41\nDepends on #42

## Comments Processing Summary
2025-08-28T11:37:45Z: Updated from platform

### Structured Updates Applied:

---
*Last updated from platform: 2025-08-28T11:37:45Z*
